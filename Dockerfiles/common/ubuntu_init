# create user
COPY root_pass root_pass
RUN echo "root:$(cat root_pass)" | chpasswd
RUN useradd hidetomo
RUN mkdir /home/hidetomo && chown hidetomo:hidetomo /home/hidetomo
COPY hidetomo_pass hidetomo_pass
RUN echo "hidetomo:$(cat hidetomo_pass)" | chpasswd

# init apt-get
RUN apt-get -y update

# sudo
RUN apt-get -y install sudo
RUN echo "hidetomo ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# change user and dir
USER hidetomo
WORKDIR /home/hidetomo
ENV HOME /home/hidetomo

# alias
RUN echo "alias ls='ls --color'" >> .bashrc
RUN echo "alias ll='ls -la'" >> .bashrc

# ssh key
COPY id_rsa .ssh/id_rsa
RUN sudo tr \\r \\n <.ssh/id_rsa> tmp && sudo mv tmp .ssh/id_rsa
RUN sudo chown hidetomo:hidetomo .ssh/id_rsa
RUN chmod 600 .ssh/id_rsa

# ssh known hosts
RUN sudo touch .ssh/known_hosts
RUN sudo chown hidetomo:hidetomo .ssh/known_hosts
RUN chmod 644 .ssh/known_hosts

# vim
RUN sudo apt-get -y install vim
COPY vimrc_simple .vimrc
RUN sudo tr \\r \\n <.vimrc> tmp && sudo mv tmp .vimrc
RUN sudo chown hidetomo:hidetomo .vimrc

# share
RUN mkdir share
VOLUME share

# common apt-get
RUN sudo apt-get -y install \
  ntp \
  zip \
  unzip \
  bzip2 \
  gcc \
  g++ \
  git \
  less \
  subversion \
  wget \
  nkf \
  fglrx \
  language-pack-ja-base \
  language-pack-ja \
  xvfb \
  xfonts-100dpi \
  xfonts-75dpi \
  xfonts-scalable \
  xfonts-cyrillic

# LC
RUN echo "export LC_ALL=ja_JP.UTF-8" >> .bashrc
ENV LC_ALL ja_JP.UTF-8

# git config
# RUN git config --global user.email 'attyamunn@gmail.com'
# RUN git config --global user.name 'hidetomo-watanabe'
